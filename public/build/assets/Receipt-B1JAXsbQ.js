import{r as o,X as y,u as D,a as O,j as e,x as P,C as v,A as w}from"./app-Dg7XWk2o.js";import{N as M}from"./index-5qWC1wVN.js";import{F as $}from"./index-Bq0lf82j.js";import{I as r}from"./index-p4sVmr16.js";import{u as E}from"./Store-CrtKikmH.js";import{Q,B as p}from"./react-toastify.esm-CqiZXVzh.js";/* empty css                      */import{I as d}from"./InputError-RdQPPGSJ.js";import"./index-CiySGR-U.js";import"./Mobile-Logo-DjYHHJYk.js";import"./CartIcon-DTmVu1Jn.js";/* empty css             */const K=()=>{const[j,u]=o.useState(!1),[t,C]=o.useState({}),{auth:R}=y().props,b=D(),k=O(),{guest:z,setGuest:N,cartItems:l,clearCart:S,calculateTotal:m,removeItem:g,updateItemQuantity:I}=E();o.useEffect(()=>{const s=JSON.parse(localStorage.getItem("guestUser"));s&&N(s)},[N]);const n=y().props.auth.user,[a,i]=o.useState({firstName:(n==null?void 0:n.first_name)??"",lastName:(n==null?void 0:n.last_name)??"",email:(n==null?void 0:n.email)??"",phone:"",address:"",note:""});o.useEffect(()=>{},[]);const f=(s,c)=>{I(s,c)},F=s=>{g(s)},_=async()=>{u(!0);try{const s=await axios.post(route("create-payment-intent"),{amount:m()*100}),{clientSecret:c}=s.data,x=await b.confirmCardPayment(c,{payment_method:{card:k.getElement(v),billing_details:{name:`${a.firstName} ${a.lastName}`,email:a.email,phone:a.phone}}});x.error?p.error(x.error.message):x.paymentIntent.status==="succeeded"&&w.post(route("process-payment"),{paymentIntentId:x.paymentIntent.id,billingDetails:a,products:l,totalCents:m()*100},{onSuccess:()=>{p.success("Order placed successfully!"),S(),w.visit("/")},onError:h=>{console.error(h),h.product_error&&p.error(h.product_error),C(h)}})}catch(s){console.error(s),p.error("Payment failed. Try again.")}finally{u(!1)}};return e.jsxs("div",{children:[e.jsx(M,{}),e.jsx("section",{className:"hero-bg d-flex align-items-center ",style:{height:"400px"},children:e.jsx("div",{className:"container  text-center",children:e.jsx(P,{href:"/cart",className:"text-decoration-none",children:e.jsxs("button",{className:"small-btn",children:[e.jsx("span",{className:"material-symbols-outlined ",children:"arrow_back"}),"Back"]})})})}),e.jsx(Q,{}),e.jsx("section",{className:"menu-section position-relative",children:e.jsxs("div",{className:"x min-vh-100 p-3",children:[" ",e.jsx("div",{className:"container",children:e.jsx("div",{className:"card mx-auto",children:e.jsxs("div",{className:"container white-bg py-5",children:[e.jsx("section",{className:"",children:e.jsxs("div",{className:"row",children:[e.jsx("h2",{className:"mb-4 text-center",children:"Additional Information"})," ",e.jsx("p",{className:"text-center",children:"Please fill in the boxes below with right information."}),e.jsx("div",{className:"col-md-12 mb-4",children:e.jsx("form",{children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx(r,{type:"text",placeholder:"Enter first name",value:a.firstName,autoComplete:"first Name",name:"firstName",onChangeMethod:s=>i(c=>({...c,firstName:s.target.value}))}),e.jsx(d,{message:t&&(t==null?void 0:t["billingDetails.firstName"]),className:"mt-2",style:{color:"red"}})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx(r,{type:"text",placeholder:"Enter last name",value:a.lastName,onChangeMethod:s=>i({...a,lastName:s.target.value})}),e.jsx(d,{message:t&&(t==null?void 0:t["billingDetails.lastName"]),className:"mt-2",style:{color:"red"}})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx(r,{type:"text",placeholder:"Enter phone number",value:a.phone,onChangeMethod:s=>i({...a,phone:s.target.value})}),e.jsx(d,{message:t&&(t==null?void 0:t["billingDetails.phone"]),className:"mt-2",style:{color:"red"}})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx(r,{type:"email",placeholder:"Enter email address",value:a.email,onChangeMethod:s=>i({...a,email:s.target.value})}),e.jsx(d,{message:t&&(t==null?void 0:t["billingDetails.email"]),className:"mt-2",style:{color:"red"}})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx(r,{type:"text",placeholder:"Enter Address",value:a.address,onChangeMethod:s=>i({...a,address:s.target.value})}),e.jsx(d,{message:t&&(t==null?void 0:t["billingDetails.address"]),className:"mt-2",style:{color:"red"}})]}),e.jsxs("div",{className:"col-12 col-md-6 bg",children:[e.jsx(r,{type:"text",placeholder:" Order Notes(Optional)",value:a.note,onChangeMethod:s=>i({...a,note:s.target.value})}),e.jsx(d,{message:t&&(t==null?void 0:t["billingDetails.notes"]),className:"mt-2",style:{color:"red"}})]}),e.jsxs("div",{className:"form-check mt-3",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"extraHotNews"}),e.jsx("label",{className:"form-check-label",htmlFor:"extraHotNews",children:"Want extra hot news? Tick the box"})]})]})})})]})}),e.jsxs("section",{className:"container mt-5 px-4 d-none d-md-block",children:[e.jsx("h3",{className:"text-center fw-bold",children:"Your Order"}),e.jsxs("p",{className:"text-center mb-4",children:["You have ",l.length," item",l.length>1&&"s"," in your order"]}),l.map((s,c)=>e.jsxs("div",{className:"d-flex align-items-center justify-content-between p-3 mb-3 shadow-sm rounded-4",style:{backgroundColor:"#fff"},children:[e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("img",{src:`/storage/${s.product_image}`,alt:s.name,style:{width:"70px",height:"70px",objectFit:"cover",borderRadius:"12px"}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-bold text-uppercase",style:{fontSize:"14px"},children:s.name}),e.jsxs("div",{className:"text-muted",style:{fontSize:"13px"},children:["$",(s==null?void 0:s.price)??""]})]})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("button",{className:"btn btn-outline-dark btn-sm",onClick:()=>f(s.id,-1),children:"â€“"}),e.jsx("span",{children:s.quantity}),e.jsx("button",{className:"btn btn-outline-dark btn-sm",onClick:()=>f(s.id,1),children:"+"}),e.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>F(s.id),children:"ðŸ—‘"})]})]},c))]}),e.jsxs("section",{className:"container my- p-1  d-block d-md-none",children:[e.jsx("h3",{className:"text-center fw-bold",children:"Your Order"}),e.jsxs("p",{className:"text-center mb-4",children:["You have ",l==null?void 0:l.length," item",l.length>1&&"s"," in your order"]}),l==null?void 0:l.map((s,c)=>e.jsx("div",{className:"d-flex flex-column flex-md-row align-items-start justify-content-between  mb-3 shadow-sm rounded-4  p-2",style:{backgroundColor:"#fff"},children:e.jsxs("div",{className:"d-flex w-100 gap-3",children:[e.jsx("img",{src:`/storage/${s.product_image}`,alt:s.name,style:{width:"70px",height:"70px",objectFit:"cover",borderRadius:"12px",flexShrink:0}}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("div",{className:"fw-bold text-uppercase",style:{fontSize:"14px"},children:s.name}),e.jsxs("div",{className:"text-muted mb-2",style:{fontSize:"13px"},children:["$",(s==null?void 0:s.price)??""]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("button",{className:"btn btn-sm btn-light",onClick:()=>decreaseQuantity(s.id),children:"â€“"}),e.jsx("div",{className:"bg-dark text-white rounded px-3 py-1",style:{fontWeight:"bold"},children:s.quantity}),e.jsx("button",{className:"btn btn-sm btn-light",onClick:()=>increaseQuantity(s.id),children:"+"}),e.jsx("button",{className:"btn btn-sm text-danger ms-auto",onClick:()=>g(s.id),children:e.jsx("i",{className:"bi bi-trash"})})]})]})]})},c))]}),e.jsxs("div",{className:"p-3 bg-inf",children:[e.jsxs("h3",{className:"text-center fw-bold",children:["Payment Summary"," "]}),e.jsx("p",{className:"text-center mb-4",children:"Enter card details for payment"})]}),e.jsx("div",{className:"py-5 bg-light-grey shadow-sm",children:e.jsx("div",{className:"col-lg-12 col-12",children:e.jsxs("div",{className:"card shadow-sm p-4",children:[e.jsx("h5",{className:"fw-bold mb-3",children:"Order Summary"}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{children:"Order"}),e.jsxs("span",{children:[l.length,"pcs"]})]}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["Â£",Number(m()||0).toFixed(2)]})]}),e.jsx("div",{className:"d-flex justify-content-between mb-2"}),e.jsxs("div",{className:"d-flex justify-content-between fw-bold border-top py-2 my-2",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["Â£",Number(m()||0).toFixed(2)]})]}),e.jsx("div",{children:e.jsx(v,{})}),e.jsx("button",{onClick:_,disabled:!b||j,className:"btn btn-danger text-white px-3 mx-3 my-5",children:j?"Processing...":"Pay Now"})]})})})]})})})]})}),e.jsx($,{})]})};export{K as default};
