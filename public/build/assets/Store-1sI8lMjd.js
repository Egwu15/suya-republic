import{U as b}from"./app-CGcEr99z.js";const O=r=>{let o;const t=new Set,n=(i,v)=>{const f=typeof i=="function"?i(o):i;if(!Object.is(f,o)){const g=o;o=v??(typeof f!="object"||f===null)?f:Object.assign({},o,f),t.forEach(d=>d(o,g))}},s=()=>o,u={setState:n,getState:s,getInitialState:()=>l,subscribe:i=>(t.add(i),()=>t.delete(i))},l=o=r(n,s,u);return u},x=r=>r?O(r):O,F=r=>r;function G(r,o=F){const t=b.useSyncExternalStore(r.subscribe,()=>o(r.getState()),()=>o(r.getInitialState()));return b.useDebugValue(t),t}const _=r=>{const o=x(r),t=n=>G(o,n);return Object.assign(t,o),t},J=r=>r?_(r):_;function N(r,o){let t;try{t=r()}catch{return}return{getItem:s=>{var e;const m=l=>l===null?null:JSON.parse(l,void 0),u=(e=t.getItem(s))!=null?e:null;return u instanceof Promise?u.then(m):m(u)},setItem:(s,e)=>t.setItem(s,JSON.stringify(e,void 0)),removeItem:s=>t.removeItem(s)}}const y=r=>o=>{try{const t=r(o);return t instanceof Promise?t:{then(n){return y(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return y(n)(t)}}}},q=(r,o)=>(t,n,s)=>{let e={storage:N(()=>localStorage),partialize:a=>a,version:0,merge:(a,S)=>({...S,...a}),...o},m=!1;const u=new Set,l=new Set;let i=e.storage;if(!i)return r((...a)=>{console.warn(`[zustand persist middleware] Unable to update item '${e.name}', the given storage is currently unavailable.`),t(...a)},n,s);const v=()=>{const a=e.partialize({...n()});return i.setItem(e.name,{state:a,version:e.version})},f=s.setState;s.setState=(a,S)=>{f(a,S),v()};const g=r((...a)=>{t(...a),v()},n,s);s.getInitialState=()=>g;let d;const p=()=>{var a,S;if(!i)return;m=!1,u.forEach(c=>{var I;return c((I=n())!=null?I:g)});const h=((S=e.onRehydrateStorage)==null?void 0:S.call(e,(a=n())!=null?a:g))||void 0;return y(i.getItem.bind(i))(e.name).then(c=>{if(c)if(typeof c.version=="number"&&c.version!==e.version){if(e.migrate)return[!0,e.migrate(c.state,c.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,c.state];return[!1,void 0]}).then(c=>{var I;const[H,j]=c;if(d=e.merge(j,(I=n())!=null?I:g),t(d,!0),H)return v()}).then(()=>{h==null||h(d,void 0),d=n(),m=!0,l.forEach(c=>c(d))}).catch(c=>{h==null||h(void 0,c)})};return s.persist={setOptions:a=>{e={...e,...a},a.storage&&(i=a.storage)},clearStorage:()=>{i==null||i.removeItem(e.name)},getOptions:()=>e,rehydrate:()=>p(),hasHydrated:()=>m,onHydrate:a=>(u.add(a),()=>{u.delete(a)}),onFinishHydration:a=>(l.add(a),()=>{l.delete(a)})},e.skipHydration||p(),d||g},w=q,L=J(w((r,o)=>({cartItems:[],addItem:t=>{r(n=>({cartItems:[...n.cartItems,{...t,quantity:1,spice:null}]}))},removeItem:t=>{r(n=>({cartItems:n.cartItems.filter(s=>s.id!==t)}))},updateItemQuantity:(t,n)=>{r(s=>({cartItems:s.cartItems.map(e=>e.id===t?{...e,quantity:Math.max(1,e.quantity+n)}:e)}))},updateItemVariance:(t,n)=>{r(s=>({cartItems:s.cartItems.map(e=>e.id===t?{...e,spice:n}:e)}))},calculateTotal:()=>{const{cartItems:t}=o();return t.reduce((n,s)=>n+s.price*s.quantity,0).toFixed(2)},clearCart:()=>{r({cartItems:[]})},guest:null,setGuest:t=>r({guest:t}),clearGuest:()=>r({guest:null}),saveGuestToLocalStorage:()=>{const{guest:t}=o();t&&localStorage.setItem("guestUser",JSON.stringify(t))},loadUserFromLocalStorage:()=>{const t=localStorage.getItem("savedGuest");t&&r({user:JSON.parse(t)})}})));export{L as u};
